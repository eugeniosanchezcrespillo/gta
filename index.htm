<!DOCTYPE html>
<!-- xlsx.js (C) 2013-present  SheetJS http://sheetjs.com -->
<!-- vim: set ts=2: -->
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Calendar GTA</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.8.0/css/bulma.min.css">
    <script defer src="https://use.fontawesome.com/releases/v5.3.1/js/all.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
</head>
<body>

	<div id="app">
	
	   <section class="hero is-success">
		  <div class="hero-body">
			<div class="container">
			  <h1 class="title">
				{{title}}
			  </h1>
			  <h2 class="subtitle">
				Convert .xls to calendar
			  </h2>
			</div>
		  </div>
		</section>

		<input type="hidden" name="format" value="csv">
				

		<input type="hidden" name="useworker">
		<input type="hidden" name="userabs">

		<section class="section">
		<div v-if="selectb"  id="drop" class="container">
		  <h1 class="title">
			Import xls file
		  </h1>
		  
		  <input type="file" name="xlfile" class="button is-success" id="xlf">
		  <button class="button is-danger" @click="parser">Convert</button>
		  
		  <!-- CSV data-->
		  <!--style="display:none;"-->
		    <div name="out" id="out"  v-show="false"></div>
			<div id="htmlout" v-show="false"></div>
		   <!-- FIN CSV data -->
		</div>
		
		<br />
		
		<div v-if="!selectb" class="container">
		  <h1 class="title">
			Select worker and timetable
		  </h1>
		 
		  <div class="select">
			  <select v-model="selectedw">
				<option disabled>Select worker</option>
				<option v-for="(w,index) in workers" :value="index">{{w}}</option>
			  </select>
			 
		  </div>
		 
		  <div class="select is-multiple">
		  
			  <select multiple size="2" id="tipo">
				<option value="8">08:00 - 20:00</option>
				<option value="9">09:00 - 21:00</option>
			  </select>
		  </div>

		  <button class="button is-info" @click="calendar">Generate Calendar</button>
		  <br />
		  <br />
		  <textarea class="textarea">{{output}}</textarea>
		  	<br />
			<br />
			<button class="button is-success" v-show="download" @click="downcalendar">Download CSV Calendar</button>
		</div>

		</section>
		
	</div>
		<!-- SCRIPTS -->
		<script src="FileSaver.js"></script>
		
		<script src="main.js"></script>
		
		<script src="shim.js"></script>

		<script type="text/vbscript" language="vbscript">
		IE_GetProfileAndPath_Key = "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders\"
		Function IE_GetProfileAndPath(key): Set wshell = CreateObject("WScript.Shell"): IE_GetProfileAndPath = wshell.RegRead(IE_GetProfileAndPath_Key & key): IE_GetProfileAndPath = wshell.ExpandEnvironmentStrings("%USERPROFILE%") & "!" & IE_GetProfileAndPath: End Function
		Function IE_SaveFile_Impl(FileName, payload): Dim data, plen, i, bit: data = CStr(payload): plen = Len(data): Set fso = CreateObject("Scripting.FileSystemObject"): fso.CreateTextFile FileName, True: Set f = fso.GetFile(FileName): Set stream = f.OpenAsTextStream(2, 0): For i = 1 To plen Step 3: bit = Mid(data, i, 2): stream.write Chr(CLng("&h" & bit)): Next: stream.Close: IE_SaveFile_Impl = True: End Function
		</script>

		<script type="text/vbscript" language="vbscript">
		Function IE_LoadFile_Impl(FileName): Dim out(), plen, i, cc: Set fso = CreateObject("Scripting.FileSystemObject"): Set f = fso.GetFile(FileName): Set stream = f.OpenAsTextStream(1, 0): plen = f.Size: ReDim out(plen): For i = 1 To plen Step 1: cc = Hex(Asc(stream.read(1))): If Len(cc) < 2 Then: cc = "0" & cc: End If: out(i) = cc: Next: IE_LoadFile_Impl = Join(out,""): End Function
		</script>

		<script src="xlsx.js"></script>
		<script src="scriptsw.js"></script>
		
		
		<!--FIN SCRIPTS-->
	
</body>
</html>