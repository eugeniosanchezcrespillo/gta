<!DOCTYPE html>
<!-- xlsx.js (C) 2013-present  SheetJS http://sheetjs.com -->
<!-- vim: set ts=2: -->
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Calendar GTA</title>
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.8.0/css/bulma.min.css">
	<link href="css/bulma-calendar.min.css" rel="stylesheet">
    <script defer src="https://use.fontawesome.com/releases/v5.3.1/js/all.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
</head>
<body>

	<div id="app">
	
	   <section class="hero is-success">
		  <div class="hero-body">
			<div class="container">
			  <h1 class="title">
				{{title}}
			  </h1>
			  <h2 class="subtitle">
				Convert multiple .xls to calendar
			  </h2>
			</div>
		  </div>
		</section>


		<section class="section">
		<div v-show="selectb" id="drop" class="container">
		  <h1 class="title">
			Import xls file(s)
		  </h1>
		  
		  <input type="file" name="xls_gta_file" class="button is-success" id="xls_gta_file" multiple>
		  <button class="button is-danger" @click="parser">Convert</button>
		 
		  <div name="out" id="out" v-show="true" ></div>
		  
		</div>
		
		<br />
		<!--!selectb-->
		<div v-if="!selectb" class="container">
		  
		 

		  <div class="tile is-ancestor">
			<div class="tile is-parent">
			  <article class="tile is-child box">
				<p class="title">Select date</p>
				<br /><br />
				<p class="subtitle"><input id="datepicker" v-model="selectdate" class="input" type="date"></p>
				<br /><br />
				<p><button class="button is-danger" @click="whoWorks">Check who works</button></p>
			  </article>
			</div>
			<div class="tile is-parent">
			  <article class="tile is-child box">
				
				<p class="title">Select worker and timetable</p>
				
				<div class="select">
					<select v-model="selectedw">
					  <option disabled>Select worker</option>
					  <option v-for="(w,index) in workers" :value="index">{{w}}</option>
					</select>
				</div>
				
				<br /><br />

				<div class="select is-multiple">
					<select multiple size="2" id="tipo">
					  <option value="8">08:00 - 20:00</option>
					  <option value="9">09:00 - 21:00</option>
					  <option value="17">H17 07-15:30 y 15:30-00</option>
					</select>
				</div>
				
				<br /><br />

				<p><button class="button is-info" @click="calendar">Generate Calendar</button></p>	
			</article>
			</div>
			
		  </div>

		  <br />
		  
		  <textarea class="textarea" >{{output}}</textarea>

		  <br /><br />
			
		  <button class="button is-success" v-show="download" @click="downcalendar">Download CSV Calendar</button>
		</div>

		</section>
		
	</div>
		<!-- SCRIPTS -->
		<script src="js/FileSaver.js"></script>
		
		<script src="js/main.js"></script>
		
		<script src="js/shim.js"></script>

		<script src="js/xlsx.js"></script>
		<script src="js/scriptsw.js"></script>
		<script src="js/bulma-calendar.min.js"></script>
		
		
		<!--FIN SCRIPTS-->
	
</body>
</html>